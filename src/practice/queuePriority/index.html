<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>微队列、交互队列、网络队列、延时队列优先级</title>
  </head>

  <body>
    <button id="begin">开始</button>
    <button id="aaa">按钮</button>
    <script>
      function delay() {
        var now = new Date()
        while (new Date() - now < 3000) {}
      }

      // 微队列
      function promise() {
        console.log("add promise")
        Promise.resolve().then(function () {
          console.log("promise end")
          console.log(document.body.style.backgroundColor)
          alert("promise end")
        })
      }

      // 延时队列
      function timer0() {
        console.log("add timer0")
        setTimeout(function () {
          console.log("timer0 end")
          alert("timer0 end")
        }, 0)
      }

      // 延时队列
      function timer1() {
        console.log("add timer1")
        setTimeout(function () {
          console.log("timer1 end")
          alert("timer1 end")
        }, 1)
      }

      // 延时队列
      function timer2() {
        console.log("add timer2")
        setTimeout(function () {
          console.log("timer2 end")
          alert("timer2 end")
        }, 2900)
      }

      // 延时队列
      function timer3() {
        console.log("add timer3")
        setTimeout(function () {
          console.log("timer3 end")
          alert("timer3 end")
        }, 500)
      }

      // 交互队列
      function event() {
        console.log("add event")
        aaa.onclick = function () {
          console.log("event end")
          alert("event end")
        }
      }

      // 网络队列
      function getFetch0() {
        console.log("add fetch0")
        fetch("./a.json").then(function (res) {
          console.log("fetch0 end")
          alert("fetch0 end")
        })
      }

      // 网络队列
      function getFetch1() {
        console.log("add fetch1")
        fetch("./a.json").then(function (res) {
          console.log("fetch1 end")
          alert("fetch1 end")
        })
      }

      begin.onclick = function () {
        document.body.style.backgroundColor = "gray"

        getFetch0()
        getFetch1()
        timer0()
        timer1()
        timer2()
        timer3()
        event()
        promise()
        console.log("===========")
        delay()

        //   add fetch0
        //   add fetch1
        //   add timer0
        //   add timer1
        //   add timer2
        //   add timer3
        //   add event
        //   add promise
        //   ===========
        //   promise end
        //   gray
        //   event end
        //   GUI会渲染页面，改变底色
        //   timer0 end
        //   fetch0 end
        //   timer1 end
        //   timer3 end
        //   timer2 end
        //   fetch1 end
      }
    </script>
  </body>
</html>
